%% Antal Spector-Zabusky's UPenn thesis formatting skeleton, 2021
%%
%% Feel free to use any of this as necessary; you can contact me about it at
%% <antal.b.sz@gmail.com>.  This isn't all the styling in my thesis; it's mostly
%% limited to things that help you satisfy the formatting guidelines instead of
%% style choices.  It does not contain styling for things I didn't include, such
%% as a dedication or an index.  I wrote this for a CS thesis, so some details
%% may be specific to that.
%%
%% This should follow the formatting guidelines from
%% <https://guides.library.upenn.edu/dissertation_manual/formatting> as of
%% Spring 2021.
%%
%% Explanatory comments are annotated with ASZ; you can delete them if you
%% want.
%%
%% Good luck!

%% ASZ: 12 point font, single-sided (don't alternate left/right margins), and
%% sensible defaults.
\documentclass[12pt,oneside,reqno]{amsbook}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%% ASZ: My usual "make things look nice and behave well" block
\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
\usepackage{lmodern}
\usepackage{microtype}
\usepackage{accsupp}
\usepackage{etoolbox}
\usepackage{newunicodechar}
\usepackage[dvipsnames,svgnames,x11names]{xcolor}
\usepackage{hyperref}
\usepackage{xspace}
\usepackage{advdate}
\usepackage[iso]{datetime}
\newdateformat{httpdate}{\shortdayofweekname{\THEDAY}{\THEMONTH}{\THEYEAR},~\THEDAY~\shortmonthname[\THEMONTH]~\THEYEAR}
\usepackage[
  backend=biber]{biblatex}
\addbibresource{bibliography.bib}

\usepackage{draft} % local
\newif\ifdraft\drafttrue
\newnote{lys}{BrickRed}
\newnote{bcp}{Chocolate}
\newnote{sz}{violet}
\newnote{ly}{orange}

\theoremstyle{definition}
\newtheorem{definition}{Definition}
\newtheorem{lemma}{Lemma}[chapter]

\def\chapterautorefname{Chapter}
\def\sectionautorefname{Section}
\def\subsectionautorefname{Subsection}
\def\subsubsectionautorefname{Subsubsection}
\def\lstnumberautorefname{Line}
\def\lemmaautorefname{Lemma}
\def\definitionautorefname{Definition}
\renewcommand{\equationautorefname}{Hypothesis}
\renewcommand{\itemautorefname}{Rule}
\usepackage{textcomp,listings,lstparams,lstcoq,graphicx,enumitem}
\lstdefinestyle{customcoq}{
  language=Coq,
  literate={<>}{$\ne$}1
  {->}{$\to$}1
  {<-}{$\gets$}1
  {=>}{$\Rightarrow$}1
  {|->}{$\mapsto$}1
  {fun}{$\lambda$}1
  {\\in}{$\in$}1
  {\\\/}{$\vee$}1
  {<>}{$\neq$}1
  {>>}{$\gg$}1
  {>>=}{$\gg\!=$}1
  {forall}{$\forall$}1
  {+'}{$\oplus$}1
  {sigma}{$\sigma$}1
}
\lstdefinestyle{json}{
  language=Coq,
  literate={@}{$@$}1
  {this}{$\ottkw{this}$}4
  {ref}{$\ottkw{ref}$}3
}
\lstdefinestyle{customc}{
  language=C,
  keywordstyle={\bfseries\codestyle\color{Keyword1Color}},
  showstringspaces=false,
  morekeywords={true,false,bool}
}
\newcommand{\http}{HTTP/1.1\xspace}
\newcommand{\inlinec}[1]{\lstinline[style=customc]{#1}}
\newcommand{\ilc}[1]{\lstinline[style=customcoq]{#1}}
\newcommand{\ilj}[1]{\lstinline[style=json]{#1}}
\lstnewenvironment{coq}{\lstset{style=customcoq}}{}
\lstnewenvironment{cpp}{\lstset{style=customc}}{}
\lstnewenvironment{json}{\lstset{style=json}}{}
\lstset{escapechar=\%,style=customcoq}

\usepackage{mathtools}
%% https://tex.stackexchange.com/a/127018
\usepackage{etoolbox}
\expandafter\patchcmd\csname \string\lstinline\endcsname{%
  \leavevmode
  \bgroup
}{%
  \leavevmode
  \ifmmode\hbox\fi
  \bgroup
}{}{%
  \typeout{Patching of \string\lstinline\space failed!}%
}

\usepackage{amssymb}
\newcommand{\complies}[2]{\mathsf{comply}_{#1}~{#2}}
\newcommand{\ncomplies}[2]{\neg(\complies{#1}{#2})}
\newcommand{\valid}[2]{\mathsf{valid}_{#1}~{#2}}
\newcommand{\invalid}[2]{\neg(\valid{#1}{#2})}
\newcommand{\accepts}[2]{\mathsf{accept}_{#1}~{#2}}
\newcommand{\rejects}[2]{\neg(\accepts{#1}{#2})}
\newcommand{\rejSound}[2]{#1\;\mathsf{sound}_{#2}^\mathfrak{Rej}}
\newcommand{\rejComplete}[2]{#1\;\mathsf{complete}_{#2}^\mathfrak{Rej}}
\newcommand{\exhaustive}[2]{\mathsf{exhaustive}_{#1}~{#2}}
\newcommand{\triggers}[3]{#1\overset{#3}\longrightarrow_{#2}}
\newcommand{\behaves}[2]{\triggers{#1}{}{#2}}
\newcommand{\llet}{\mathsf{let}\;}
\newcommand{\iin}{\mathsf{in}\;}
\newcommand{\letin}[2]{\llet#1=#2\;\iin}
\newcommand{\option}{\mathsf{option}\;}
\newcommand{\Some}[1]{\mathsf{Some}\;#1}
\newcommand{\None}{\mathsf{None}}
\newcommand{\sigT}[2]{\{\exists#1,#2\}}
\newcommand{\existT}[3]{\mathsf{pack}\;#1=#2\;\mathsf{with}\;#3}
\newcommand{\sstep}{\mathsf{sstep}}
\newcommand{\vstep}{\mathsf{vstep}}
\newcommand{\Server}{\mathsf{Server}}
\newcommand{\Validator}{\mathsf{Validator}}
\newcommand{\stepServer}{\mathsf{stepServer}}
\newcommand{\stepValidator}{\mathsf{stepValidator}}
\newcommand{\lam}[2]{\lambda#1\Rightarrow#2}
\newcommand{\Set}{\mathsf{set}\;}
\newcommand{\List}{\mathsf{list}\;}
\newcommand{\nil}{\varepsilon}
\newcommand{\If}{\mathsf{if}\;}
\newcommand{\tthen}{\mathsf{then}\;}
\newcommand{\Then}{\;\tthen}
\newcommand{\eelse}{\mathsf{else}\;}
\newcommand{\Else}{\;\eelse}
\newcommand{\Unit}{()}
\newcommand{\Tt}{()}
\newcommand{\Nat}{\mathbb N}
\newcommand{\Int}{\mathbb Z}
\newcommand{\Bool}{\mathbb B}
\newcommand{\True}{\mathsf{true}}
\newcommand{\False}{\mathsf{false}}
\newcommand{\Is}{\;\mathsf{is}\;}
\newcommand{\Prog}{\mathsf{Prog}}
\newcommand{\Lang}{\textsf{QAC-Lang}}
\newcommand{\serverOf}{\mathsf{serverOf}}
\newcommand{\validatorOf}{\mathsf{validatorOf}}
\newcommand{\Return}{\mathsf{return}}
\newcommand{\Sexp}{\mathsf{SExp}}
\newcommand{\Mem}{\mathsf{mem}}
\newcommand{\Exec}{\mathsf{exec}}
\newcommand{\update}[3]{#1[#2\mapsto#3]}
\newcommand{\constraint}{\mathsf{constraint}}
\newcommand{\Fresh}{\mathsf{fresh}\;}
\newcommand{\solvable}{\mathsf{solvable}\;}
\newcommand{\Vexp}{\mathsf{VExp}}
\newcommand{\oop}{\;op\;}
\newcommand{\ccmp}{\;cmp\;}
\newcommand{\Var}{\mathsf{var}}
\newcommand{\Reflects}[2]{#1\sim #2}
\newcommand{\satisfy}[2]{#1\;\mathsf{satisfy}\;#2}
\newcommand{\Jref}[3]{#1.#2.#3}
\newcommand{\Jpath}{\mathsf{Jpath}}
\newcommand{\This}{\mathsf{this}}
\newcommand{\Number}{\#}
\newcommand{\At}{@}
\newcommand{\Write}{\mathsf{write}}
\newcommand{\Havoc}{\mathsf{havoc}}

%% ASZ: `amsbook` didn't style `\paragraph`s appropriately
\patchcmd{\paragraph}{\normalfont}{\itshape}
  {} % Success
  {\GenericError
     {} % Continuation for \MessageBreak (unused)
     {Could not redefine \string\paragraph\space to be italic}
     {(This is a hack in the preamble.)} % Where to look for more info?
     {I tried to replace \string\normalfont\space with \string\itshape, but I
      couldn't.}}

%% ASZ: Change the spacing in the list of figures – I don't know if you need
%% this or not
\makeatletter
\patchcmd{\l@figure}{1.5pc}{2.25pc}
  {} % Success
  {\GenericError
     {} % Continuation for \MessageBreak (unused)
     {Could not fix the spacing in the list of figures}
     {(This is a hack in the preamble.)} % Where to look for more info?
     {I tried to replace the 1.5pc figure number--figure description separation
      with a 2.25pc separation in \string\l@figure\space, but I couldn't.}}

%% ASZ: I like it when tables of contents know where they are
\patchcmd{\@starttoc}{\ifx\contentsname}{\iffalse}
  {} % Success
  {\GenericError
     {} % Continuation for \MessageBreak (unused)
     {Could not add a line to the table of contents for itself}
     {(This is a hack in the preamble.)} % Where to look for more info?
     {I tried to replace the check in \string\@starttoc\space that suppresses a
      table of contents entry for the table of contents, but I couldn't.}}

%% ASZ: The other half of the above
\patchcmd{\@starttoc}{\@tocwrite}{\phantomsection\@tocwrite}
  {} % Success
  {\GenericError
     {} % Continuation for \MessageBreak (unused)
     {Could not add link targets to the table of contents/front matter lists}
     {(This is a hack in the preamble.)} % Where to look for more info?
     {I tried to add \string\phantomsection\space to \string\@starttoc\space so
      that it would generate hyperlink targets, but I couldn't.}}
\makeatother

%% ASZ: Set the page layout correctly: 1.5" margins on the left, 1" margins
%% everywhere else, page numbers count
\usepackage{fullpage}
\usepackage[margin=1in,left=1.5in,includeheadfoot]{geometry}

%% ASZ: Make footnote numbers run continuously, rather than restart at the start
%% of every chapter; this is required by the formatting guidelines
\counterwithout*{footnote}{chapter}

%% ASZ: I found these to be much clearer
\numberwithin{section}{chapter}
\numberwithin{figure}{chapter}
\numberwithin{equation}{chapter}
\numberwithin{definition}{chapter}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%% ASZ: This is a package for generating and styling the various "preliminary
%% pages": title page, copyright page, and abstract
\usepackage{upenn-dissertation-preliminary-pages} % local
\NoSignatureLines %% ASZ: For COVID – turns off adding lines on the title page
                  %% for people to sign.  The default is \YesSignatureLines.
\SingleSpaceAbstract %% ASZ: I think it looks better than a double-spaced
                     %% abstract, although in deference to the guidelines,
                     %% \DoubleSpaceAbstract is the default.

%% ASZ: Fill out your own information here :-)  Some notes:
%%
%% * You need to specify your advisor, the graduate chair, and your committee
%%   members, even if there's overlap between these groups.
%%
%%   * Your external committee member(s) need both their title and their
%%   affiliation; below, just imagine that everyone but Gödel works at Penn.
%%
%% * Note that some of the faculty involved for you may be assistant or
%%   associate professors (but I couldn't bring myself to apply that title to
%%   any of these luminaries).  I don't believe extra titles (e.g., "ENIAC
%%   President's Distinguished Professor") are necessary.
%%
%% * Only one committee chair is supported; you'll need to modify
%%   `upenn-dissertation-preliminary-pages.sty` (or email me about it) to change
%%   that.
%%
%% * When rendering the title page, your chair (if present) comes first,
%%   followed by the rest of the committee in the same order as in the TeX.
%%
%% * Using a Creative Commons license is optional, and thus so is specifying
%%   `\creativecommons`.  If you want to use one, choose from the licenses
%%   available at <https://creativecommons.org/licenses/>, perhaps by using the
%%   license chooser at <https://creativecommons.org/choose/>.  You'll have to
%%   copy the name of the  license (including the short string) and the URL
%%   separately, as you can see with the text below (the license I used); I
%%   didn't build a LaTeX Creative Commons license parser (yet? :-)).
\title{Testing by Dualization}
\author{Yishuai Li}
\graduategroup{Computer and Information Science}
\graduationyear{2022}
\advisor{Benjamin C. Pierce}{Professor of Computer and Information Science}
\graduatechair{Mayur Naik}{Professor of Computer and Information Science}
\committeechair{Steve Zdancewic}{Professor of Computer and Information Science}
\committeemember{Mayur Naik}{Professor of Computer and Information Science}
\committeemember{Boon Thau Loo}{Professor of Computer and Information Science}
\committeemember{John Hughes}{Professor of Computing Science, Chalmers University of Technology}
\creativecommons
  {Attribution-Share\-Alike 4.0 International (CC BY-SA 4.0)}
  {https://creativecommons.org/licenses/by-sa/4.0/}

\begin{document}

%% ASZ: Roman page numbers
\frontmatter

\maketitle

\copyrightpage

\chapter*{Acknowledgments}
\label{chap:acknowledgments}

Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor
incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis
nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo
consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum
dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident,
sunt in culpa qui officia deserunt mollit anim id est laborum.

%% ASZ: ... the rest of your acknowledgments go here ...

%% ASZ: The `upenn-dissertation-preliminary-pages` package will correctly style
%% this, including your thesis name, your name, and your advisor's name.
\begin{abstract}{chap:abstract}
  Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor
  incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis
  nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo
  consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse
  cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non
  proident, sunt in culpa qui officia deserunt mollit anim id est laborum.
\end{abstract}

\tableofcontents
\listoffigures

%% ASZ: Arabic page numbers
\mainmatter

\chapter{Introduction}
\label{chap:introduction}
\input{intro}

\chapter{Dualization Theory}
\label{chap:theory}
\input{theory}

\chapter{Testing in Practice}
\label{chap:practices}
\input{practice}

\chapter{Test Harness Design}
\label{chap:harness}
\input{harness}

\chapter{Evaluation}
\label{chap:eval}
\input{eval}

\chapter{Related Work}
\label{chap:related-work}
\input{related}

\chapter{Discussions}
\label{chap:discussion}

\chapter{Conclusion}
\label{chap:conclusion}

\printbibliography
  %% ASZ: AucTeX (the Emacs package for LaTeX I used) doesn't support a `.bib`
  %% file and a `.tex` file with the same name

\appendix

\chapter{Mathematical Proof of Derived Validators' Correctness}
\label{chap:math-proof}
\input{math-proof}

\chapter{Unstructured contents}
\input{issta}

\end{document}
